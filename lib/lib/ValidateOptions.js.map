{"version":3,"sources":["../../src/lib/ValidateOptions.es6"],"names":[],"mappings":"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","file":"ValidateOptions.js","sourcesContent":["/**\n * Created by michaelsilvestre on 7/06/15\n */\n\nimport validUrl from 'valid-url'\nimport getmac from 'getmac'\n\nexport default class ValidateOptions {\n  constructor(options) {\n    this._options = options;\n  }\n\n  get extras() {\n    return {\n      isMacAddress: (value) => {\n        return getmac.isMac(value);\n      }\n    }\n  }\n\n  get optionSchema() {\n    return {\n      url: { type: \"string\" },\n      applicationId: { type: \"number\" },\n      key: { type: \"string\", len: 40 },\n      password: { type: \"string\", len: 80 },\n      macAddress: { type: \"string\", len: 17, extras: [\"isMacAddress\"] }\n    }\n  };\n\n  valide(key, value) {\n    if (!this.optionSchema.hasOwnProperty(key)) {\n      return new Error(`The option: ${key}, not exist`);\n    }\n    if (typeof(value) !== this.optionSchema[key].type) {\n      return new Error(`The type of: ${key}, is not ${this.optionSchema[key].type}`);\n    }\n    if (this.optionSchema[key].hasOwnProperty('len') && value.length !== this.optionSchema[key].len) {\n      return new Error(`The length of: ${key}, is not equal to ${this.optionSchema[key].len}`);\n    }\n    if (this.optionSchema[key].hasOwnProperty('extras')) {\n      let result = this.optionSchema[key]['extras'].filter((extra) => {\n        return !this.extras[extra](value)\n      });\n      if (result > 0) {\n        return new Error(`There is an error in the extras values ${result}`);\n      }\n    }\n    return value;\n  };\n\n  execute() {\n    let result = {};\n    if (typeof(this._options) === 'string') {\n      result = { err: null, result: { url: this._options, options: {} } };\n    }\n\n    if (typeof(this._options) === 'object') {\n      if (!this._options.hasOwnProperty('url')) {\n        return new Error('No url found');\n      }\n      let optionValues = Object.keys(this._options).map((value) => {\n        return this.valide(value, this._options[value]);\n      });\n      let optionValidate = optionValues.filter((value) => {\n        return (value instanceof Error) || value === \"\"\n      });\n      if (optionValidate.length > 0) {\n        let errors = optionValidate.map((value) => {\n          return value.message\n        }).join(', ');\n        return { err: new Error(`Error in options: ${errors}`), result: null };\n      }\n      let url = this._options.url;\n      delete this._options.url;\n      let option = Object.keys(this._options).map((value) => {\n        return `${value}=${this._options[value]}`;\n      }).join('&');\n\n      result = { err: null, result: { url: url, options: option, raw: this._options } };\n    }\n\n    if (!validUrl.is_uri(result.result.url)) {\n      return { err: new Error(`The URL: ${result.result.url}, is not valid`), result: null };\n    }\n\n    return result;\n  }\n\n}\n\n"]}