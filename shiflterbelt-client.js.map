{"version":3,"sources":["shiflterbelt-client.es6"],"names":[],"mappings":"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","file":"shiflterbelt-client.js","sourcesContent":["/**\n * Created by michaelsilvestre on 25/04/15\n */\n\nimport events from \"events\"\nimport socketClient from 'socket.io-client'\nimport validUrl from 'valid-url'\nimport getmac from 'getmac'\nimport { _extend } from 'util'\n\nfunction validateOption(options) {\n  let extras = {\n    mac_address: (value) => {\n      return getmac.isMac(value);\n    }\n  };\n\n  let optionSchema = {\n    url: { type: \"string\" },\n    applicationId: { type: \"number\" },\n    key: { type: \"string\", len: 40 },\n    password: { type: \"string\", len: 80 },\n    macAddress: { type: \"string\", len: 17, extra: [\"mac_address\"] }\n  };\n\n  let valide = (key, value) => {\n    if (!optionSchema.hasOwnProperty(key)) {\n      return new Error(`The option: ${key}, not exist`);\n    }\n    if (typeof(value) !== optionSchema[key].type) {\n      return new Error(`The type of: ${key}, is not ${optionSchema[key].type}`);\n    }\n    if (optionSchema[key].hasOwnProperty('len') && value.length !== optionSchema[key].len) {\n      return new Error(`The length of: ${key}, is not equal to ${optionSchema[key].len}`);\n    }\n    if (optionSchema[key].hasOwnProperty('extras')) {\n      let result = optionSchema[key]['extras'].filter((extra) => {\n        return !extras[extra](value)\n      });\n      if (result > 0) {\n        return new Error(`There is an error in the extras values ${result}`);\n      }\n    }\n    return value;\n  };\n\n  let result = {};\n  if (typeof(options) === 'string') {\n    result = { err: null, result: { url: options, options: {} } };\n  }\n\n  if (typeof(options) === 'object') {\n    let url = \"\";\n    let option = {};\n\n    if (!options.hasOwnProperty('url')) {\n      return new Error('No url found');\n    }\n    let optionValues = Object.keys(options).map((value) => {\n      return valide(value, options[value]);\n    });\n    let optionValidate = optionValues.filter((value) => {\n      return (value instanceof Error) || value === \"\"\n    });\n    if (optionValidate.length > 0) {\n      let errors = optionValidate.map((value) => {\n        return value.message\n      }).join(', ');\n      return { err: new Error(`Error in options: ${errors}`), result: null };\n    }\n    url = options.url;\n    delete options.url;\n    option = Object.keys(options).map((value) => {\n      return `${value}=${options[value]}`;\n    }).join('&');\n\n    result = { err: null, result: { url: url, options: option, raw: options } };\n  }\n\n  if (!validUrl.is_uri(result.result.url)) {\n    return { err: new Error(`The URL: ${result.result.url}, is not valid`), result: null };\n  }\n\n  return result;\n\n}\n\nclass AnalyseContentRemove {\n  constructor(content, context) {\n    this._content = content;\n    this._context = context;\n  }\n\n  master() {\n    let listName = `_${this._content['role']}s`;\n    if (!this._context.hasOwnProperty(listName)) {\n      return;\n    }\n    console.log('goodbye message: ' + \"goodbye slave: \" + this._content['id']);\n    delete(this._context[listName][this._content['id']]);\n  }\n\n  init() {\n    try {\n      this[this._context['role']]();\n    } catch (e) {\n      console.warn(e);\n    }\n  }\n}\n\nclass AnalyseContentAdd {\n  constructor(content, context) {\n    this._content = content;\n    this._context = context;\n  }\n\n  master() {\n    let listName = `_${this._content['role']}s`;\n    if (!this._context.hasOwnProperty(listName)) {\n      return;\n    }\n    console.log('welcome message: ' + \"hello slave: \" + this._content['id']);\n    this._context[listName][this._content['id']] = this._content;\n    this._context._socket.emit('message', JSON.stringify({\n      key: this._content['id'],\n      message: JSON.stringify({ key: 'event', value: \"Welcome slave: \" + this._content['id'] })\n    }));\n  }\n\n  init() {\n    try {\n      this[this._context['role']]();\n    } catch (e) {\n      console.warn(e);\n    }\n  }\n}\n\nclass AnalyseMessage {\n  constructor(message, context) {\n    this._message = message;\n    this._context = context;\n  }\n\n  identification(content) {\n    _extend(this._context, content);\n  }\n\n  connection(content) {\n    let analyseContent = new AnalyseContentAdd(content, this._context);\n    analyseContent.init();\n    console.log(this._context._slaves); // TODO: Can be deleted\n  }\n\n  slaveList(contents) {\n    contents.forEach((content) => {\n      (new AnalyseContentAdd(content, this._context)).init();\n    });\n    console.log(this._context._slaves); // TODO: Can be deleted\n  }\n\n  slaveDisconnected(content) {\n    let analyseContent = new AnalyseContentRemove(content, this._context);\n    analyseContent.init();\n    console.log(this._context._slaves); // TODO: Can be deleted\n  }\n\n  init() {\n    try {\n      this[this._message['action']](this._message['content']);\n    } catch (e) {\n      console.warn(e);\n    }\n  }\n}\n\nexport default class ShifterbeltClient {\n  constructor(options) {\n    this._obj1 = new events.EventEmitter();\n    this._obj2 = new events.EventEmitter();\n    this._connected = false;\n    this._masters = {};\n    this._managers = {};\n    this._slaves = {};\n    getmac.getMac((err, macAddress) => {\n      options.macAddress = options.macAddress || macAddress; // TODO : Remove: \"options.macAddress ||\"\n      this.init(options);\n    });\n  }\n\n  init(options) {\n\n    let valide = validateOption(options);\n\n    if (valide.err) {\n      return console.log(valide.err.message);\n    }\n\n    this._socket = socketClient(valide.result.url, { query: valide.result.options });\n\n    this._socket.on('connect', () => {\n      //this._obj1.emit('connect');\n      this._socket.emit('authenticate', JSON.stringify(valide.result.raw));\n      this._socket.on('authenticated', () => {\n        this._connected = true;\n        this._socket.on('message', (message) => {\n          let chunk = {};\n          if (message.hasOwnProperty('content')) {\n            let result = JSON.parse(message.content.toString());\n            chunk[result['key']] = result['value'];\n          } else {\n            chunk = message;\n          }\n          var keys = Object.keys(chunk);\n          if (keys.length !== 1) {\n            return;\n          }\n          this._obj1.emit(keys[0], chunk[keys[0]]);\n        });\n        this._socket.on('service', (message) => {\n          let analyseMessage = new AnalyseMessage(message, this);\n          analyseMessage.init();\n        });\n        this._obj2.addListener('send', (data) => {\n          /*\n           let jsonObj = JSON.parse(data);\n\n           if (!jsonObj.value) {\n           this._socket.emit(jsonObj.key);\n           return;\n           }\n           this._socket.emit(jsonObj.key, jsonObj.value);\n           */\n          this._socket.emit('message', data);\n        });\n        this._obj1.emit('connect');\n      });\n    });\n\n    this._socket.on('disconnect', () => {\n      this._connected = false;\n    });\n  }\n\n\n  on(event, callback) {\n    this._obj1.addListener(event, callback);\n  }\n\n  get error() {\n    return this._error;\n  }\n\n  emit(event, ...args) {\n    if (!this._connected) {\n      return;\n    }\n    let message;\n    let callback = null;\n    if (args.length === 0) {\n      message = null;\n    }\n    if (args.length === 1) {\n      if (\"function\" === typeof args[0]) {\n        callback = args[0];\n      } else {\n        message = args[0];\n      }\n\n    }\n    if (args.length > 1) {\n      let sliceTotal = args.length;\n      if (\"function\" === typeof args.length) {\n        sliceTotal = sliceTotal - 1;\n        callback = args[sliceTotal - 1];\n      }\n      message = args.slice(0, sliceTotal).join(\" \");\n    }\n    this._obj2.emit('send', JSON.stringify({ key: event, value: message }));\n\n    if (callback) {\n      callback();\n    }\n  }\n\n}"]}